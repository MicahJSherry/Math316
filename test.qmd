---
title: "Cloud Cover – Pittsburgh Weather"
format: revealjs
execute:
  echo: false
  warning: false
  message: false


---

## Cloud Cover – Monthly Trends

```{python}
import altair as alt
import pandas as pd

alt.renderers.enable("default")

# Load data
df = pd.read_csv("Pittsburgh_hourly_normals_1981_2010.csv")
df["DATE"] = pd.to_datetime("2000-" + df["DATE"].astype(str), errors="coerce")
df["Month"] = df["DATE"].dt.month

# Rename cloud columns
cloud_columns = {
    "HLY-CLOD-PCTCLR": "Clear",
    "HLY-CLOD-PCTFEW": "Few",
    "HLY-CLOD-PCTSCT": "Scattered",
    "HLY-CLOD-PCTBKN": "Broken",
    "HLY-CLOD-PCTOVC": "Overcast"
}
df = df.rename(columns=cloud_columns)

cloud_monthly = df.groupby("Month")[list(cloud_columns.values())].mean().reset_index()

cloud_long = cloud_monthly.melt("Month", var_name="Condition", value_name="Percent")

chart = alt.Chart(cloud_long).mark_line(point=True).encode(
    x="Month:O",
    y="Percent:Q",
    color="Condition:N"
).properties(title="Average Cloud Cover by Month (1981–2010)",
    width=700,
    height=500
)

chart
```


---


## Dataset Overview

```{python}
# Drop all *_ATTRIBUTES columns
df_clean = df.loc[:, ~df.columns.str.contains("_ATTRIBUTES")]

# Rename key variables
rename_map = {
    "HLY-CLOD-PCTCLR": "Cloud",        # collapse clouds into one category for overview
    "HLY-DEWP-NORMAL": "DewPoint",
    "HLY-PRES-NORMAL": "Pressure",
    "HLY-TEMP-NORMAL": "Temperature",
    "HLY-WIND-VCTSPD": "Wind"
}
df_clean = df_clean.rename(columns=rename_map)

# Dataset shape
rows, cols = df_clean.shape
print(f"Dataset contains {rows:,} rows and {cols} columns (after dropping attributes)")

# Show representative column groups
print("\nKey column categories:")
print("- Station info: STATION, DATE, LATITUDE, LONGITUDE, ELEVATION, NAME")
print("- Weather variables: Cloud, DewPoint, Pressure, Temperature, Wind")
```

---

## Cloud Cover – Clear vs Overcast

```{python}
# Group monthly averages
cloud_compare = df.groupby("Month")[["Clear", "Overcast"]].mean().reset_index()

# Melt to long format
cloud_compare_long = cloud_compare.melt(
    id_vars="Month",
    var_name="Condition",
    value_name="Percent"
)

# Single grouped bar chart
chart = alt.Chart(cloud_compare_long).mark_bar().encode(
    x=alt.X("Month:O", title="Month"),
    y=alt.Y("Percent:Q", title="Frequency (%)"),
    color=alt.Color("Condition:N", title="Condition"),
    tooltip=["Month:O", "Condition:N", "Percent:Q"]
).properties(
    title="Clear vs Overcast Sky Frequency by Month",
    width=700,
    height=500
)

chart
```



---

## Cloud Cover Distribution (All Months)

```{python}
# Take monthly averages, then melt into long format
cloud_monthly = df.groupby("Month")[list(cloud_columns.values())].mean().mean().reset_index()
cloud_monthly.columns = ["Condition", "Percent"]

# Altair pie chart
pie = alt.Chart(cloud_monthly).mark_arc().encode(
    theta=alt.Theta(field="Percent", type="quantitative"),
    color=alt.Color(field="Condition", type="nominal"),
    tooltip=[
        alt.Tooltip(field="Condition", type="nominal"),
        alt.Tooltip(field="Percent", type="quantitative", format=".1f")
    ]
).properties(
    title="Overall Cloud Cover Distribution (1981–2010, Pittsburgh)",
    width=700,
    height=500
)

pie
```
---

## Cloud Cover Scatter – All Types

```{python}
# Recompute cloud_monthly so it keeps Month
cloud_monthly = df.groupby("Month")[[
    "Clear", "Few", "Scattered", "Broken", "Overcast"
]].mean().reset_index()

# Melt to long format
cloud_long = cloud_monthly.melt(
    id_vars="Month",
    var_name="Condition",
    value_name="Percent"
)

# Scatter plot
chart = alt.Chart(cloud_long).mark_point(size=80).encode(
    x=alt.X("Condition:N", title="Cloud Type"),
    y=alt.Y("Percent:Q", title="Cloud Cover (%)"),
    color="Condition:N",
    tooltip=["Month:O", "Condition:N", "Percent:Q"]
).interactive().properties(
    title="Cloud Cover Scatter – All Types by Month",
    width=700,
    height=500
)

chart
```


---

## Key Questions for Dashboard

- **a**  
- **b**  
- **c**  